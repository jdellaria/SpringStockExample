Drop table if exists mkyong.tHistoricalValue; CREATE TABLE mkyong.tHistoricalValue SELECT mkyong.HistoricalPrices.Symbol, mkyong.HistoricalPrices.Close,  mkyong.HistoricalPrices.DateStamp, mkyong.Assets.TotalQuantity, (select mkyong.HistoricalPrices.Close * mkyong.Assets.TotalQuantity) as Valuation  FROM mkyong.HistoricalPrices, mkyong.Assets where mkyong.HistoricalPrices.Symbol = mkyong.Assets.Symbol;



Drop table if exists mkyong.tHistoricalValue; CREATE TABLE mkyong.tHistoricalValue 
SELECT mkyong.HistoricalPrices.Symbol, mkyong.HistoricalPrices.Close,  mkyong.HistoricalPrices.DateStamp, mkyong.AssetsCopy.TotalQuantity,
 (select mkyong.HistoricalPrices.Close * mkyong.AssetsCopy.TotalQuantity) as Valuation 
 FROM mkyong.HistoricalPrices, mkyong.AssetsCopy where ( (mkyong.HistoricalPrices.Symbol = mkyong.AssetsCopy.Symbol) and (mkyong.HistoricalPrices.DateStamp between mkyong.AssetsCopy.StartDate and mkyong.AssetsCopy.EndDate))


Drop table if exists mkyong.tHistoricalValue; CREATE TABLE mkyong.tHistoricalValue 
SELECT mkyong.HistoricalPrices.Symbol, mkyong.HistoricalPrices.Close,  mkyong.HistoricalPrices.DateStamp, mkyong.AssetsCopy.TotalQuantity,
 (select mkyong.HistoricalPrices.Close * mkyong.AssetsCopy.TotalQuantity) as Valuation 
 FROM mkyong.HistoricalPrices, mkyong.AssetsCopy where ( (mkyong.HistoricalPrices.Symbol = mkyong.AssetsCopy.Symbol) and (mkyong.HistoricalPrices.DateStamp between mkyong.AssetsCopy.StartDate and (if (mkyong.AssetsCopy.EndDate is null,current_date(),mkyong.AssetsCopy.EndDate))))
